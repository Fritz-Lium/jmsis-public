<meta charset="utf-8" />

<style>
	#table th:nth-child(4), 
	#table td:nth-child(4) {
		padding-left: 30px;
	}
	
	#table > thead > tr:last-child > th:nth-child(2), #table td:nth-child(2),
	#table > thead > tr:last-child > th:nth-child(3), #table td:nth-child(3),
	#table > thead > tr:last-child > th:nth-child(5), #table td:nth-child(5),
	#table > thead > tr:last-child > th:nth-child(6), #table td:nth-child(6) {
		min-width: 115px;
		padding: 5px;
		text-align: right;
	}
</style>

<table id="table" class="hidden" data-colspans="6">
	<script type="text/html" id="tmpl-titles">
		<caption>
			<i class="icon-th-list"></i>{{year2}}年企业职工基本养老保险基金预算表
		</caption>
		<thead>
			<tr>
				<th>社预02表</th>
				<th colspan="4">区域: 江门市</th>
				<th class="text-right">单位: 元</th>
			</tr>
			<tr>
				<th>项目</th>
				<th>{{year1}}年执行数</th>
				<th>{{year2}}年预算数</th>
				<th>项目</th>
				<th>{{year1}}年执行数</th>
				<th>{{year2}}年预算数</th>
			</tr>
		</thead>
	</script>
	<tbody>
		<tr>
			<td>一、基本养老保险费收入</td><td></td><td></td>
			<td>一、基本养老金支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>二、利息收入</td><td></td><td></td>
			<td>二、医疗补助金支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>三、财政补贴收入</td><td></td><td></td>
			<td>三、丧葬抚恤补助支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>其中: 本级财政补助</td><td></td><td></td>
			<td></td><td></td><td></td>
		</tr>
		<tr>
			<td>四、其他收入</td><td></td><td></td>
			<td>四、其他支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>五、转移收入</td><td></td><td></td>
			<td>五、转移支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>六、本年收入小计</td><td></td><td></td>
			<td>六、本年支出小计</td><td></td><td></td>
		</tr>
		<tr>
			<td>七、上级补助收入</td><td></td><td></td>
			<td>七、补助下级支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>八、下级上解收入</td><td></td><td></td>
			<td>八、上解上级支出</td><td></td><td></td>
		</tr>
		<tr>
			<td>九、本年收入合计</td><td></td><td></td>
			<td>九、本年支出合计</td><td></td><td></td>
		</tr>
		<tr>
			<td></td><td></td><td></td>
			<td>十、本年收支结余</td><td></td><td></td>
		</tr>
		<tr>
			<td>十、上年结余</td><td></td><td></td>
			<td>十一、年末滚存结余</td><td></td><td></td>
		</tr>
		<tr>
			<td>总计</td><td></td><td></td>
			<td>总计</td><td></td><td></td>
		</tr>
	</tbody>
</table>

<script>
	var $table = $frame.find('table'),
		budgetID = parseInt(getURLParams()['ID']);

	
	/*
	$.get('modules/FD_ctl.jsp?action=Detail', {
		'ID': budgetID
	}, function(resTxt){
		var resObj = $.parseJSON(resTxt);
		showTable(resObj);
	});
	*/
	showTable(null);

	function showTable(resObj){

		// 测试数据
		var fakeTVALUES = {
			"B1": "2012年执行数",
			"B2": "4794250652.08",
			"B3": "57883448.72",
			"B6": "1164808.04",
			"B7": "21227384.85",
			"B8": "4874526293.69",
			"B9": "170340000.00",
			"B10": "23864901.00",
			"B11": "5068731194.69",
			"B13": "4503035646.92",
			"B14": "9571766841.61",
			"C1": "2013年预算数",
			"C2": "4535256150.45",
			"C3": "64201139.85",
			"C6": "1185875.23",
			"C7": "2465870.44",
			"C8": "4625301865.97",
			"C9": "167000000.00",
			"C10": "21654826.00",
			"C11": "4813956691.97",
			"C13": "6148609899.36",
			"C14": "10962566591.33",
			"E1": "2012年执行数",
			"E2": "3063423060.38",
			"E3": "0.00",
			"E4": "64410851.21",
			"E6": "0.00",
			"E7": "33813902.82",
			"E8": "3161647814.41",
			"E9": "0.00",
			"E10": "261509127.84",
			"E11": "3423156942.25",
			"E12": "1645574252.44",
			"E13": "6148609899.36",
			"E14": "9571766841.61",
			"F1": "2013年执行数",
			"F2": "3731210158.14",
			"F3": "0.00",
			"F4": "76671626.75",
			"F6": "0.00",
			"F7": "38701872.67",
			"F8": "3846583657.56",
			"F9": "0.00",
			"F10": "283537640.86",
			"F11": "4130121298.42",
			"F12": "683835393.55",
			"F13": "6832445292.91",
			"F14": "10962566591.33"
		}
		resObj = {
			'TVALUES': fakeTVALUES,
			'year': 2012
		}

		$table.addClass('hidden');
		var tValues = resObj['TVALUES'],
			year = resObj['year'],
			$tmplTitles = $table.find('#tmpl-titles'),
			matrix = _.reduce(tValues, function(memo, val, key){
				var mat = key.match(/^(\w)(\d+)$/),
						c = parseInt(mat[1].charCodeAt(0) - 65),
						r = parseInt(mat[2] - 1);
				memo[r] = memo[r] || [];
				memo[r][c] = val;
				return memo;
			}, []);
		$tmplTitles.after(_.template($tmplTitles.html(), {
			year1: year, year2: year + 1
		}));
		var $trows = $table.find('thead > tr:last, tbody > tr');
		_.each(matrix, function(row, i){
			var $trow = $trows.eq(i);
			_.each(row, function(val, j){
				if (_.isUndefined(val)) return;
				$trow.children().eq(j).text(val);
			});
		});
		$table.removeClass('hidden');
	}
</script>